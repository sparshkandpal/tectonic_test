<div class="admin-container">
  <div class="admin-header">
    <h1>Edit Dish</h1>
    <%= link_to 'Back to Stories', stories_path, class: 'back-link' %>
  </div>

  <%= form_with model: @dish, local: true, multipart: true, class: 'dish-form' do |form| %>
    <% if @dish.errors.any? %>
      <div class="error-messages">
        <h2><%= pluralize(@dish.errors.count, "error") %> prohibited this dish from being saved:</h2>
        <ul>
          <% @dish.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="form-group">
      <%= form.label :restaurant_id, "Restaurant" %>
      <%= form.collection_select :restaurant_id, @restaurants, :id, :name, {}, { class: 'form-control' } %>
    </div>

    <div class="form-group">
      <%= form.label :name %>
      <%= form.text_field :name, class: 'form-control' %>
    </div>

    <div class="form-group">
      <%= form.label :description %>
      <%= form.text_area :description, rows: 4, class: 'form-control' %>
    </div>

    <div class="form-group">
      <%= form.label :base_price %>
      <%= form.number_field :base_price, step: 0.01, class: 'form-control' %>
    </div>

    <div class="form-group">
      <%= form.label :image, "Dish Image" %>
      <%= form.file_field :image, accept: 'image/*', class: 'form-control' %>
      <% if @dish.image.attached? %>
        <div class="image-preview">
          <%= image_tag @dish.image, style: 'max-width: 200px; margin-top: 10px;' %>
          <p class="image-note">Current image (upload new to replace)</p>
        </div>
      <% end %>
    </div>

    <div class="form-actions">
      <%= form.submit 'Update Dish', class: 'btn btn-primary' %>
    </div>
  <% end %>
</div>

<%= render 'dishes/form_styles' %>

