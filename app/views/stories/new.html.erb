<div class="admin-container">
  <div class="admin-header">
    <h1>Add Story for Dish</h1>
    <%= link_to 'Back to Stories', stories_path, class: 'back-link' %>
  </div>

  <%= form_with model: @story, local: true, multipart: true, class: 'story-form' do |form| %>
    <% if @story.errors.any? %>
      <div class="error-messages">
        <h2><%= pluralize(@story.errors.count, "error") %> prohibited this story from being saved:</h2>
        <ul>
          <% @story.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="form-group">
      <%= form.label :restaurant_id, "Restaurant" %>
      <%= form.collection_select :restaurant_id, @restaurants, :id, :name, { prompt: "Select a restaurant" }, { class: 'form-control' } %>
    </div>

    <div class="form-group">
      <%= form.label :dish_id, "Dish (Optional - for customization)" %>
      <%= form.collection_select :dish_id, Dish.all, :id, :name, { prompt: "Select a dish (optional)" }, { class: 'form-control' } %>
      <small class="form-text">Optional: Link a dish for customization features</small>
    </div>

    <div class="form-group">
      <%= form.label :position %>
      <%= form.number_field :position, class: 'form-control' %>
      <small class="form-text">Position for ordering stories (lower numbers appear first)</small>
    </div>

    <div class="form-group">
      <%= form.label :image, "Story Image (for carousel/thumbnail)" %>
      <%= form.file_field :image, accept: 'image/*', class: 'form-control' %>
      <small class="form-text">Upload an image to display in the story carousel. If not provided, will use dish image or first media item.</small>
    </div>

    <div class="form-actions">
      <%= form.submit 'Create Story', class: 'btn btn-primary' %>
      <p class="form-note">After creating the story, you'll be able to add media items (images/videos).</p>
    </div>
  <% end %>
</div>

<%= render 'dishes/form_styles' %>

